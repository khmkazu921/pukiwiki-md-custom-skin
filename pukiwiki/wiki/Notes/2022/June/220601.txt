#notemd
# Status Meeting

  - Latch borrowing

  - Level sensitive vs Edge sensitive

  - 仕様を紙で理解する

# Tech Sharing

## DDR PHY Sassa-san

  - Skew balancing b/w PHY \<-\> IO
      - crossing connections
      - skew balancing with every Byte
  - Byte/AC Macro ??

## USB Lin-san

  - PG connections
      - PG isolation + issue
  - ESD protection
      - ESD  
        Electro Static Discharge is sudden flow of static electricity
        between two electrically charged objects for a very short
        duration of time.
  - Floorplanning considerations
  - Isolation buffer :: alchip
      - vs Isolation cell

## Mixed-placer Takemoto-san

  - Top and Bottom with Innovus

## Mixed-placer Tsuji-san

  - Innovus yields better except length

## Useful-skew Sakurada-san

## Power Recovery during CCD Lin-san

  - FF size down issue
      - CTS-trial, no effect?
  - Non-default Rule issues ?

## Acceptance Checklist Ishii-san

# Self Study

## 高島さんのコメント

  - クロックサイクルを意識しない、もっと抽象度の高いHDLを動作記述という？

## Unit 8

``` tcl
lappend linkpath tech_lib.db RAMmode.db 
source application_variables.tcl SI specific variable settings 
set si_enable_analysis true; # options are shownin bold.
read_verilog ORCA.v; current_design ORCA; linkdesign
read_parasitics -keep_capacitive_coupling -format GPD gpd_dir
# read_parasitics -keepcapacitive_coupling -format spef ORCA.spef.gz
source func_maxPVI_constraints.tcl
update_timing
check_timing
report_analysis_coverage
report_timing -crosstalk
save_session func_maxPVT_savesession
print_message_info; quit
```

  - Stage delay
      - The cell + net delay
      - Min/max rise/fall delays
  - Overlapping timing windows
      - Victim nets that switch around the same time as aggressor nets
        are said to have “overlapping timing windows”.
  - Delta delay
  - Delta slew
  - Switching bumps
      - expressed as a ratio of VDD
      - a switching bump is measured when the victim is transitioning.

### Reading Parasitics

    read_parasitics -keep_capacitive_coupling clock_gen.spef
    report_annotated_parasitics -list_not_annotated
    
    # To 
    print_message_info
    # To generate a report
    report_delay_calculation

  - Recommendation  
    read parasitics prior to reading constraints

<!-- end list -->

  - RC-, PARA- or DES- warnings indicate delay calculation, parasitic,
    design or library issues
  - IO drive and load constraint
      - `set_driving_cell`, `set_load`, `set_clock_latency`
    
      - Do not use `set_input_transition`
        
        ``` tcl
        set_driving_cell -lib_cell buffd1 -max [all_inputs]
        set_driving_cell -lib_cell buffd7 -min [all_inputs]
        set_load -max $max [all_outputs]
        set_load -min $min [all_outputs]
        set_clock_latency -early $min -source [get_clock clk]
        set_clock_latency -late $max -source [getclock clk] 
        ```
    
      - Constraining Input Ports
        
        ``` tcl
        set_input_delay -max 3 -clock CLK [get_ports A]
        set_input_delay -min 2 -clock CLK [get_ports A]
        ```

### Asynchronous , Logically Exclusive Clocks

  - Asynchronous Clocks  
    analyzed *conservatively* causing delta delay due to crosstalk ??
    
      - Infinite arrival windows  
        For asynchronous clocks, PrimeTime SI assumes the transitions
        can occur at any time.
    
    <!-- end list -->
    
      - **No timing analysis, Infinite window crosstalk analysis**

  - Logically Exclusive Clocks  
    analyzed for possibly causing delta delay due to crosstalk
    
      - No timing analysis, Crosstalk calculated using overlapping
        timing windows

  - Physically Exclusive clocks  
    no timing analysi, no crosstalk analysis
    
    ``` tcl
    # SDC :
    set_clock_groups -asynchronous -group [CLKA CLKA_div2] -group CLK_OSCs
    set_clock_groups -logically_exclusive -group CLK -group TEST_CLK
    
    create_clock -name CLK_FUNC [get_ports CLK] -period 6
    create_clock -name CLK_TEST [get_ports CLK] -period 120 -add
    set_clock_groups -physicallyexclusive —group CLK_FUNC -group CLK_TEST
    ```

<!-- end list -->

  - Do not use `set_false_path` for asynchronous clocks
  - Do not use both set_falsepath and clock groups
  - Do not over constrain synchronous clocks (by changing clock period)

### Static nets

  - cannot be an aggressor nor victim for crosstalk delay analysis
    
    ``` tcl
    set_case_analysis 0 test_mode
    set_si_delay_analysis -exclude -victims/-aggressors [get_nets test_mode]
    ```

### Crosstalk-related CRP ??

CRP due to crosstalk should not be removed. Non-crosstalk related CRP
should be removed. This is because crosstalk can affect different clock
edges in different ways and thus subsequent clock edges can have
different delays to the commonpoint.

## Lab 5 Revision

``` tcl
pt_shell> report_timing -to I_ORCA_TOP/I_BLENDER/latched_clk_en_reg/D
****************************************
Report : timing
    -path_type full
    -delay_type max
    -max_paths 1
    -sort_by slack
Design : ORCA
Version: O-2018.06
Date   : Wed Jun  1 08:29:17 2022
****************************************


  Startpoint: I_ORCA_TOP/I_PARSER/blender_clk_en_reg
               (rising edge-triggered flip-flop clocked by SYS_CLK)
  Endpoint: I_ORCA_TOP/I_BLENDER/latched_clk_en_reg
               (negative level-sensitive latch clocked by SYS_CLK)
  Last common pin: I_ORCA_TOP/bufbdfG5B7I1/Z
  Path Group: SYS_CLK
  Path Type: max
  Min Clock Paths Derating Factor : 0.9000

  Point                                                   Incr       Path
  ------------------------------------------------------------------------------
  clock SYS_CLK (rise edge)                             0.0000     0.0000
  clock network delay (propagated)                      2.7139     2.7139
  I_ORCA_TOP/I_PARSER/blender_clk_en_reg/CP (sdcrb1)    0.0000     2.7139 r
  I_ORCA_TOP/I_PARSER/blender_clk_en_reg/Q (sdcrb1)     0.4621 &   3.1759 r
  I_ORCA_TOP/I_BLENDER/latched_clk_en_reg/D (slnlq1)    0.0044 &   3.1804 r
  data arrival time                                                3.1804

  clock SYS_CLK (fall edge)                             4.0000     4.0000
  clock network delay (propagated)                      2.3250     6.3250
  clock reconvergence pessimism                         0.3203     6.6454
  I_ORCA_TOP/I_BLENDER/latched_clk_en_reg/EN (slnlq1)              6.6454 f
  time borrowed from endpoint                           0.0000     6.6454
  data required time                                               6.6454
  ------------------------------------------------------------------------------
  data required time                                               6.6454
  data arrival time                                               -3.1804
  ------------------------------------------------------------------------------
  slack (MET)                                                      3.4650

  Time Borrowing Information
  ------------------------------------------------------------------
  SYS_CLK nominal pulse width                           4.0000 
  clock latency difference                              0.0346 
  library setup time                                   -0.2367 
  ------------------------------------------------------------------
  max time borrow                                       3.7979 
  actual time borrow                                    0.0000 
  ------------------------------------------------------------------


1
pt_shell> set_annotated_delay -net 4 -to I_ORCA_TOP/I_BLENDER/latched_clk_en_reg/D
1
pt_shell> report_timing -to I_ORCA_TOP/I_BLENDER/latched_clk_en_reg/D
Information: Updating design - Started                    (UITE-214)
Information: Updating design -   Calculating delays       (UITE-214)
Information: Updating design -     Calculating delays 100%... (UITE-214)
Information: Updating design -   Calculating delays       (UITE-214)
Information: Updating design -   Calculating arrivals     (UITE-214)
Information: Updating design -     Calculating arrivals  100%... (UITE-214)
Information: Updating design -   Calculating slacks       (UITE-214)
Information: Updating design -     Calculating slacks (max type) for groups  (UITE-214)
Information: Updating design -     Calculating slacks (min type) for groups  (UITE-214)
Information: Updating design - Completed                  (UITE-214)
****************************************
Report : timing
    -path_type full
    -delay_type max
    -max_paths 1
    -sort_by slack
Design : ORCA
Version: O-2018.06
Date   : Wed Jun  1 08:29:54 2022
****************************************


  Startpoint: I_ORCA_TOP/I_PARSER/blender_clk_en_reg
               (rising edge-triggered flip-flop clocked by SYS_CLK)
  Endpoint: I_ORCA_TOP/I_BLENDER/latched_clk_en_reg
               (negative level-sensitive latch clocked by SYS_CLK)
  Last common pin: I_ORCA_TOP/bufbdfG5B7I1/Z
  Path Group: SYS_CLK
  Path Type: max
  Min Clock Paths Derating Factor : 0.9000

  Point                                                   Incr       Path
  ------------------------------------------------------------------------------
  clock SYS_CLK (rise edge)                             0.0000     0.0000
  clock network delay (propagated)                      2.7139     2.7139
  I_ORCA_TOP/I_PARSER/blender_clk_en_reg/CP (sdcrb1)    0.0000     2.7139 r
  I_ORCA_TOP/I_PARSER/blender_clk_en_reg/Q (sdcrb1)     0.4621 &   3.1759 r
  I_ORCA_TOP/I_BLENDER/latched_clk_en_reg/D (slnlq1)    4.0000 *   7.1759 r
  data arrival time                                                7.1759

  clock SYS_CLK (fall edge)                             4.0000     4.0000
  clock network delay (propagated)                      2.3250     6.3250
  clock reconvergence pessimism                         0.3203     6.6454
  I_ORCA_TOP/I_BLENDER/latched_clk_en_reg/EN (slnlq1)              6.6454 f
  time borrowed from endpoint                           0.5306     7.1759
  data required time                                               7.1759
  ------------------------------------------------------------------------------
  data required time                                               7.1759
  data arrival time                                               -7.1759
  ------------------------------------------------------------------------------
  slack (MET)                                                      0.0000

  Time Borrowing Information
  ------------------------------------------------------------------
  SYS_CLK nominal pulse width                           4.0000 
  clock latency difference                              0.0346 
  library setup time                                   -0.2367 
  ------------------------------------------------------------------
  max time borrow                                       3.7979 
  ------------------------------------------------------------------
  actual time borrow                                    0.5306 
  open edge CRPR                                        0.3203 
  ------------------------------------------------------------------
  time given to startpoint                              0.8509 
  ------------------------------------------------------------------

pt_shell> report_timing -trace_latch_borrow -fro I_ORCA_TOP/I_BLENDER/latched_clk_en_reg/D
****************************************
Report : timing
    -path_type full
    -delay_type max
    -max_paths 1
    -trace_latch_borrow
    -sort_by slack
Design : ORCA
Version: O-2018.06
Date   : Wed Jun  1 08:46:22 2022
****************************************

  Startpoint: I_ORCA_TOP/I_BLENDER/latched_clk_en_reg
               (negative level-sensitive latch clocked by SYS_CLK)
  Endpoint: I_ORCA_TOP/I_BLENDER/U794
               (rising clock gating-check end-point clocked by SYS_CLK)
  Path Group: **clock_gating_default**
  Path Type: max
  Min Clock Paths Derating Factor : 0.9000

  Time is borrowed from the startpoint of this path.
  The following is a forward trace from the origin of
  the borrow.

  Path Segment: #1
  Startpoint: I_ORCA_TOP/I_PARSER/blender_clk_en_reg
               (rising edge-triggered flip-flop clocked by SYS_CLK)
  Endpoint: I_ORCA_TOP/I_BLENDER/latched_clk_en_reg
               (negative level-sensitive latch clocked by SYS_CLK)

  Point                                                   Incr       Path
  ------------------------------------------------------------------------------
  clock SYS_CLK (rise edge)                             0.0000     0.0000
  clock network delay (propagated)                      2.7139     2.7139
  I_ORCA_TOP/I_PARSER/blender_clk_en_reg/CP (sdcrb1)    0.0000     2.7139 r
  I_ORCA_TOP/I_PARSER/blender_clk_en_reg/Q (sdcrb1)     0.4621 &   3.1759 r
  I_ORCA_TOP/I_BLENDER/latched_clk_en_reg/D (slnlq1)    4.0000 *   7.1759 r
  data arrival time                                                7.1759

  clock SYS_CLK (fall edge)                             4.0000     4.0000
  clock network delay (propagated)                      2.3250     6.3250
  clock reconvergence pessimism                         0.3203     6.6454
  I_ORCA_TOP/I_BLENDER/latched_clk_en_reg/EN (slnlq1)              6.6454 f
  time borrowed from endpoint                           0.5306     7.1759
  data required time                                               7.1759
  ------------------------------------------------------------------------------
  data required time                                               7.1759
  data arrival time                                               -7.1759
  ------------------------------------------------------------------------------
  slack (MET)                                                      0.0000

  Time Borrowing Information
  ------------------------------------------------------------------
  SYS_CLK nominal pulse width                           4.0000 
  clock latency difference                              0.0346 
  library setup time                                   -0.2367 
  ------------------------------------------------------------------
  max time borrow                                       3.7979 
  ------------------------------------------------------------------
  actual time borrow                                    0.5306 
  open edge CRPR                                        0.3203 
  ------------------------------------------------------------------
  time given to startpoint                              0.8509 
  ------------------------------------------------------------------


  Path Segment: #2
  Startpoint: I_ORCA_TOP/I_BLENDER/latched_clk_en_reg
               (negative level-sensitive latch clocked by SYS_CLK)
  Endpoint: I_ORCA_TOP/I_BLENDER/U794
               (rising clock gating-check end-point clocked by SYS_CLK)

  Point                                                   Incr       Path
  ------------------------------------------------------------------------------
  clock SYS_CLK (fall edge)                             4.0000     4.0000
  clock network delay (propagated)                      2.3250     6.3250
  time given to startpoint                              0.8509     7.1759
  I_ORCA_TOP/I_BLENDER/latched_clk_en_reg/D (slnlq1)    0.0000     7.1759 r
  I_ORCA_TOP/I_BLENDER/latched_clk_en_reg/Q (slnlq1)    0.3164 &   7.4924 r
  I_ORCA_TOP/I_BLENDER/U794/B1 (ora21d4)                0.0263 &   7.5186 r
  data arrival time                                                7.5186

  clock SYS_CLK (rise edge)                             8.0000     8.0000
  clock network delay (propagated)                      1.6425     9.6425
  clock reconvergence pessimism                         0.0000     9.6425
  I_ORCA_TOP/I_BLENDER/U794/A (ora21d4)                            9.6425 r
  clock gating setup time                              -0.2000     9.4425
  data required time                                               9.4425
  ------------------------------------------------------------------------------
  data required time                                               9.4425
  data arrival time                                               -7.5186
  ------------------------------------------------------------------------------
  slack (MET)                                                      1.9239

  ==============================================================================


1


  1 source /apps/synopsys/pt_vO-2018.06/admin/setup/.synopsys_pt.setup            |  1 source /apps/synopsys/pt_vO-2018.06/admin/setup/.synopsys_pt.setup             
  2 source /proj_training/Training_2019/WORK/JP/kazuki_furukawa/Labs_PT_2018.06/P\|  2 source /proj_training/Training_2019/WORK/JP/kazuki_furukawa/Labs_PT_2018.06/PT\
    T_2018.06/lab1_flow/.synopsys_pt.setup                                        |    _2018.06/lab4_clocks/.synopsys_pt.setup                                        
  3 # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\|  3 # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \
     -                                                                            |    -                                                                              
  4 # PrimeTime STA run script for ORCA                                           |  4 # PrimeTime STA run script for ORCA                                            
  5 # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\|  5 # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \
     -                                                                            |    -                                                                              
  6 ########################                                                      |  6 ########################                                                       
  7 # Setup                                                                       |  7 # Setup                                                                        
  8 source ./common_setup.tcl                                                     |  8 set search_path {. ../ref/libs ../ref/scripts ../ref/design_data}              
  9 source ./pt_setup.tcl                                                         |  9 lappend link_path sc_max.db io_max.db mem_max.db special.db                    
 10 # Allow source to use search_path                                             | 10 source ./scripts/orca_pt_variables.tcl                                         
 11 set sh_source_uses_search_path true                                           | 11 ########################                                                       
 12 # Do not allow black boxes for unresolved references                          | 12 # READ and LINK                                                                
 13 set link_create_black_boxes false                                             | 13 read_verilog orca_routed.v.gz                                                  
 14 ########################                                                      | 14 link_design -keep ORCA                                                         
 15 # READ and LINK                                                               | 15 read_parasitics ORCA.SPEF.gz                                                   
 16 read_verilog orca_routed.v.gz                                                 | 16 ########################                                                       
 17 link_design ORCA                                                              | 17 # Apply constraints and check                                                  
 18 read_parasitics ../ref/design_data/ORCA.SPEF.gz                               | 18 source orca_pt_constraints.tcl                                                 
 19 ########################                                                      | 19 set timing_remove_clock_reconvergence_pessimism true                           
 20 # Apply constraints                                                           | 20 update_timing                                                                  
 21 source -echo -verbose orca_pt_constraints.tcl                                 | 21 ########################                                                       
 22 ########################                                                      | 22 # Generate initial reports                                                     
 23 # Save session                                                                | 23 ########################                                                       
 24 file delete -force orca_savesession                                           | 24 # Save the session                                                             
                                                                                  | 25 file delete -force orca_savesession                                            
```

``` tcl
set timing_remove_clock_reconvergence_pessimism true
```
